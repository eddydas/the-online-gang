# Issue 1.10: Lobby System

**Sprint:** 1
**Priority:** CRITICAL
**Estimate:** 6 hours
**Status:** TODO

## Description
Implement the lobby system where players join, set names, and ready up before game starts.

## Tasks
- [ ] Player name input (20 char max)
- [ ] Ready/Unready toggle (locks name when ready)
- [ ] Host "Start Game" button (enabled with min 2 players, all ready)
- [ ] Player list display (shows all connected players)
- [ ] Late joiner detection → show lobby, wait for next game
- [ ] Copy shareable link button (host only)

## HTML Structure
```html
<div id="lobby-screen">
  <h1>The Online Gang</h1>

  <div id="connection-info">
    <!-- Host: shows shareable link -->
    <!-- Client: shows "Connected to [host name]" -->
  </div>

  <div id="player-setup">
    <input
      id="player-name"
      type="text"
      maxlength="20"
      placeholder="Your name">
    <button id="ready-toggle">Ready</button>
  </div>

  <div id="player-list">
    <h2>Players (2/8)</h2>
    <ul>
      <!-- List of players with ready status -->
    </ul>
  </div>

  <button id="start-game" disabled>Start Game</button>
  <!-- Only visible to host, enabled when 2+ players all ready -->
</div>
```

## Type Safety
```javascript
// @ts-check

/**
 * @typedef {Object} LobbyPlayer
 * @property {string} id - Player ID
 * @property {string} name - Player name (max 20 chars)
 * @property {boolean} isReady - Ready status
 * @property {boolean} isHost - Host flag
 */

/**
 * Renders lobby screen
 * @param {LobbyPlayer[]} players - All players in lobby
 * @param {boolean} isHost - Whether current player is host
 * @returns {void}
 */

/**
 * Validates player name
 * @param {string} name - Player name input
 * @returns {boolean} True if valid
 */
```

## Files to Create/Modify
- `src/ui/lobby.js` - Lobby UI rendering
- `tests/ui/lobby.test.js` - Lobby tests (optional for Sprint 1)
- Update `index.html` with structure

## Acceptance Criteria
- [ ] Name input limited to 20 characters
- [ ] Ready toggle locks name input
- [ ] Player list shows all players with ready status
- [ ] Host sees "Start Game" button
- [ ] Start Game enabled only when 2+ players all ready
- [ ] Late joiner sees lobby (if game in progress)
- [ ] Copy link button for host (shareable URL)
- [ ] Type checking passes (`npm run typecheck`)

## Player List Display
```
Players (3/8)
• Alice (Host) ✓
• Bob ✓
• Charlie ...
```

## Late Joiner Behavior
- Join during game → show lobby screen
- Message: "Game in progress. You'll join the next round."
- Wait in lobby until current game ends
- Automatically join when game resets to CARD_DEAL

## Validation Rules
- Name: 1-20 characters, no empty string
- Ready: Can't ready with empty name
- Start: Requires 2+ players, all ready

## Notes
- Simple styling (full polish in Sprint 2)
- Focus on functionality and state management
- Integration with P2P connection (Issue 1.7)
- Integration with state machine (Issue 1.8)
