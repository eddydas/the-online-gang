# Issue 2.4: Hand Strength Assistant

**Sprint:** 2 v2
**Priority:** HIGH
**Estimate:** 6 hours
**Status:** TODO

## Description
Implement a real-time hand strength assistant that helps players understand their current poker hand strength. This displays the hand name and highlights the best 5 cards in yellow, updating automatically as community cards are revealed.

## User Story
As a player, I want to see my current hand strength displayed in real-time so that I can make informed token selections without needing to manually calculate poker hand rankings.

## Acceptance Criteria
- [ ] Hand name displayed above player's cards (e.g., "Three of a Kind", "Flush")
- [ ] Best 5 cards highlighted in yellow border
- [ ] Updates automatically when community cards are revealed
- [ ] Works for all poker hand types (High Card → Royal Flush)
- [ ] Highlights only the 5 cards used in the best hand
- [ ] Mobile-friendly layout
- [ ] No performance issues (updates within 100ms)
- [ ] Hand name styling is clear and readable

## Technical Implementation

### Hand Evaluation Integration
```javascript
import { evaluateHand } from './poker.js';

/**
 * Evaluates and displays current hand strength for a player
 * @param {Card[]} holeCards - Player's hole cards
 * @param {Card[]} communityCards - Community cards on table
 * @returns {HandEvaluation}
 */
function evaluatePlayerHand(holeCards, communityCards) {
  const allCards = [...holeCards, ...communityCards];
  const handEvaluation = evaluateHand(allCards);

  return {
    name: handEvaluation.name,
    rank: handEvaluation.rank,
    bestFive: handEvaluation.cards, // The 5 cards used in best hand
    description: handEvaluation.description
  };
}
```

### HTML Structure
```html
<div class="player-hand-container">
  <!-- Hand name display -->
  <div class="hand-name-display">
    <span class="hand-name">Three of a Kind</span>
    <span class="hand-description">(Three 7s)</span>
  </div>

  <!-- Player cards (some highlighted) -->
  <div class="player-cards">
    <div class="card best-five" data-rank="7" data-suit="♠"></div>
    <div class="card best-five" data-rank="7" data-suit="♥"></div>
  </div>

  <!-- Community cards (some highlighted) -->
  <div class="community-cards">
    <div class="card best-five" data-rank="7" data-suit="♦"></div>
    <div class="card" data-rank="K" data-suit="♠"></div>
    <div class="card" data-rank="2" data-suit="♥"></div>
  </div>
</div>
```

### CSS Styling
```css
/* Hand name display */
.hand-name-display {
  text-align: center;
  margin-bottom: 12px;
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
}

.hand-name {
  display: block;
  font-size: 18px;
  font-weight: bold;
  color: #f39c12; /* Gold color for hand name */
  text-shadow: 0 1px 2px rgba(0,0,0,0.3);
}

.hand-description {
  display: block;
  font-size: 12px;
  color: #ecf0f1;
  margin-top: 4px;
}

/* Best five card highlight (already defined in 2.2) */
.card.best-five {
  border: 2px solid #f39c12;
  box-shadow: 0 0 8px rgba(243, 156, 18, 0.6);
}

/* Mobile adjustments */
@media (max-width: 768px) {
  .hand-name {
    font-size: 14px;
  }

  .hand-description {
    font-size: 10px;
  }
}
```

### JavaScript Implementation
```javascript
/**
 * Update hand strength display for current player
 * @param {Player} player - Current player
 * @param {Card[]} communityCards - Community cards
 */
function updateHandStrengthDisplay(player, communityCards) {
  const holeCards = player.holeCards || [];

  if (holeCards.length === 0) return;

  // Evaluate hand
  const handEval = evaluatePlayerHand(holeCards, communityCards);

  // Update hand name display
  const handNameEl = document.querySelector('.hand-name');
  const handDescEl = document.querySelector('.hand-description');

  if (handNameEl) {
    handNameEl.textContent = handEval.name;
  }

  if (handDescEl) {
    handDescEl.textContent = `(${handEval.description})`;
  }

  // Remove previous highlights
  document.querySelectorAll('.card.best-five').forEach(card => {
    card.classList.remove('best-five');
  });

  // Highlight best 5 cards
  highlightBestFive(handEval.bestFive);
}

/**
 * Highlight the best 5 cards in the hand
 * @param {Card[]} bestFive - Best 5 cards
 */
function highlightBestFive(bestFive) {
  bestFive.forEach(card => {
    const cardEl = findCardElement(card.rank, card.suit);
    if (cardEl) {
      cardEl.classList.add('best-five');
    }
  });
}

/**
 * Find card element by rank and suit
 * @param {string} rank - Card rank (A, K, Q, J, 10, 9, etc.)
 * @param {string} suit - Card suit (♠, ♥, ♦, ♣)
 * @returns {HTMLElement | null}
 */
function findCardElement(rank, suit) {
  return document.querySelector(
    `.card[data-rank="${rank}"][data-suit="${suit}"]`
  );
}
```

## Update Triggers

The hand strength display should update on these events:
1. **Community cards revealed** (flop, turn, river)
2. **Player ready-up** (initial display)
3. **State sync** (for clients receiving updated game state)

```javascript
// In gameController.js or main.js
function onStateUpdate(newState) {
  // ... existing state update logic ...

  // Update hand strength if in game
  if (newState.phase !== 'LOBBY' && newState.phase !== 'END_GAME') {
    const currentPlayer = getCurrentPlayer(newState);
    if (currentPlayer) {
      updateHandStrengthDisplay(currentPlayer, newState.communityCards);
    }
  }
}
```

## Performance Considerations
- **Debouncing**: Not needed - hand only updates when state changes (not continuous)
- **Card matching**: Use data attributes for O(1) lookup
- **Evaluation caching**: Reuse existing evaluateHand() logic (already optimized)
- **DOM updates**: Only update when hand actually changes (compare previous hand name)

## Hand Description Examples
```javascript
const HAND_DESCRIPTIONS = {
  'Royal Flush': (cards) => 'Royal Flush',
  'Straight Flush': (cards) => `${cards[0].rank}-high Straight Flush`,
  'Four of a Kind': (cards) => `Four ${cards[0].rank}s`,
  'Full House': (cards) => `${cards[0].rank}s full of ${cards[3].rank}s`,
  'Flush': (cards) => `${cards[0].rank}-high Flush`,
  'Straight': (cards) => `${cards[0].rank}-high Straight`,
  'Three of a Kind': (cards) => `Three ${cards[0].rank}s`,
  'Two Pair': (cards) => `${cards[0].rank}s and ${cards[2].rank}s`,
  'Pair': (cards) => `Pair of ${cards[0].rank}s`,
  'High Card': (cards) => `${cards[0].rank} high`
};
```

## Files to Create/Modify
- `src/browser/handStrengthAssistant.js` - New module for hand strength display
- `src/browser/gameController.js` - Add updateHandStrengthDisplay() calls on state updates
- `src/browser/main.js` - Initialize hand strength assistant
- CSS file or inline styles for hand name display

## Testing Checklist
- [ ] Hand name displays correctly for all 10 hand types
- [ ] Best 5 cards highlighted correctly (yellow border)
- [ ] Updates when flop is revealed (Turn 2)
- [ ] Updates when turn card is revealed (Turn 3)
- [ ] Updates when river card is revealed (Turn 4)
- [ ] No highlights during Turn 1 (no community cards)
- [ ] Works correctly for tied hands (e.g., split pots)
- [ ] Hand description is accurate (e.g., "Three 7s")
- [ ] Mobile layout works (readable font sizes)
- [ ] No performance issues (< 100ms update time)
- [ ] Works for all player counts (2-8)

## Edge Cases
- **No community cards yet (Turn 1)**: Display "No hand yet" or hide display
- **Only hole cards**: Evaluate best hand from 2 cards only (will be Pair or High Card)
- **Tied hands**: Both players may have same hand name (show correctly for each)
- **Partial community cards**: Works with 3, 4, or 5 community cards

## Dependencies
- Issue 1.3 (Poker Hand Evaluation) - Uses evaluateHand()
- Issue 2.2 (Card Visual Design) - Uses .best-five CSS class
- Issue 1.2 (Card Rendering) - Requires data-rank and data-suit attributes

## Notes
- This is a UX enhancement - helps beginners understand poker
- Updates should be instant (< 100ms) - no loading indicators needed
- Highlighting best 5 is critical for teaching poker hand selection
- Reuse existing poker.js evaluateHand() - no new evaluation logic needed

## Definition of Done
- [ ] Hand name displays above player cards
- [ ] Best 5 cards highlighted with yellow border
- [ ] Updates automatically on community card reveal
- [ ] Works for all 10 poker hand types
- [ ] Mobile responsive design
- [ ] No performance issues
- [ ] Tested on Safari iOS, macOS, iPad
- [ ] Code passes typecheck
- [ ] Approved by product owner
